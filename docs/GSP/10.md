---
title: "第十章：有限长脉冲响应滤波器和窗函数"
createTime: 2026/01/29 21:36:14
permalink: /GSP/0skntymp/
---

:::note
本章核心：研究理想滤波器的不可实现性及其改进方法；系统介绍窗函数法（含性能分析与设计流程）；阐述**广义线性相位 FIR 滤波器**的四种类型及频谱结构；补充频率抽样法与误差最大最小优化法。
:::

## §1 理想滤波器及其存在的问题

### 1. 理想滤波器

:::table align="center" fullWidth copy=false
| 滤波器类型         | 频谱$H(f)$（$\|f\| \le \frac{1}{2\Delta}$）                                                               | 说明                             |
| ------------------ | --------------------------------------------------------------------------------------------------------- | -------------------------------- |
| **理想低通**       | $H_1(f) = \begin{cases}1, & \|f\| \le f_1 \\ 0, & f_1 < \|f\| \le \frac{1}{2\Delta} \end{cases}$          | $f_1$：高通频率                  |
| **理想带通**       | $H_2(f) = \begin{cases}1, & f_1 < \|f\| \le f_2 \\ 0, & \text{其他} \end{cases}$                          | $f_1$：低通频率；$f_2$：高通频率 |
| **理想高通**       | $H_3(f) = \begin{cases}0, & \|f\| \le f_1 \\ 1, & f_1 < \|f\| \le \frac{1}{2\Delta} \end{cases}$          | $f_1$：高截频率                  |
| **理想带阻**       | $H_4(f) = \begin{cases}0, & f_1 < \|f\| \le f_2 \\ 1, & \text{其他} \end{cases}$                          | $f_1$：低截频率；$f_2$：高截频率 |
| **希尔伯特滤波器** | $H_5(f) = \begin{cases} -i, & 0 < f \le \frac{1}{2\Delta} \\ i, & -\frac{1}{2\Delta} < f < 0 \end{cases}$ | 用于 90° 相移                    |
| **理想微分滤波器** | $H_6(f) = i2\pi f$                                                                                        | 对应微分运算                     |
:::
:::note
**对应的时域脉冲响应**

- 理想低通：$h_1(n) = \dfrac{\sin 2\pi f_1 n \Delta}{\pi n \Delta}$
- 希尔伯特：$h_5(n) = \begin{cases} 0, & n = 0 \\ \dfrac{1 - (-1)^n}{\pi n \Delta}, & n \ne 0 \end{cases}$
- 理想微分：$h_6(n) = \begin{cases} 0, & n = 0 \\ \dfrac{2\cos \pi n}{n \Delta}, & n \ne 0 \end{cases}$

:::

### 2. 理想滤波器存在的问题

- **根本问题**：理想滤波器的时域脉冲响应 $h(n)$ 无限长。

- **截尾引起的吉布斯现象**：

  将 $h(n)$ 截尾为有限长 $h_N(n) = h(n) \cdot g_N(n)$（$g_N$为矩形窗），其频谱 $H_N(f)$ 在理想突变点（如 $\pm f_1$）附近产生严重振荡。

![](/GSP/gibbs-phenomenon.png)

### 3. 近似理想滤波器技术指标（以低通为例）

定义于圆频率 $\omega = 2\pi \Delta f$ 域：

$$
\begin{cases}
1 - \delta_p \le |H(\omega)| \le 1 + \delta_p, & 0 \le \omega \le \omega_p \\
|H(\omega)| \le \delta_s, & \omega_s \le \omega \le \pi
\end{cases}
$$

![](/GSP/filter-specifications.png)

- $\omega_p$：通带截止频率  
- $\omega_s$：阻带起始频率  
- $\delta_p$：通带波动  
- $\delta_s$：阻带波动

- 过渡带：$[\omega_p, \omega_s]$，中点$\frac{1}{2}(\omega_p + \omega_s)$对应理想截频
- 分贝表示：$\alpha_p = 20\lg(1 - \delta_p)$，$\alpha_s = 20\lg \delta_s$

## §2 时窗函数

### 1. 矩形时窗与截尾效应

- **矩形时窗**：

  $$
  g_N(n) = \begin{cases} 1, & |n| \le N \\ 0, & \text{其他} \end{cases}
  $$
  对应频谱（主瓣+旁瓣）：
  $$
  G_N(f) = \frac{\sin 2\pi (N + \tfrac{1}{2}) \Delta f}{\sin \pi \Delta f}
  $$

  ![](/GSP/rectangular-window-f.png)

- **主瓣宽度**：$2f_N = \frac{2}{(2N+1)\Delta}$

- **吉布斯现象成因**：

  截尾频谱 $X_N(f) = X(f) * G_N(f)$，主瓣使原频谱平滑，旁瓣泄漏引起振荡。

- **好的时窗函数要求**：
  1. 旁瓣峰值低，减小泄漏效应；
  2. 主瓣宽度窄，提高频率分辨率。

### 2. 常用时窗函数

#### 2.1 矩形（Rectangular）时窗

$$
w_1(t) =
\begin{cases}
1, & |t| \le T \\\\
0, & |t| > T
\end{cases}
$$

$$
W_1(f) = \frac{\sin 2\pi f T}{\pi f}
$$

#### 2.2 三角形（Bartlett）时窗

$$
w_2(t) =
\begin{cases}
1 - \dfrac{|t|}{T}, & |t| \le T \\\\
0, & \text{其他}
\end{cases}
$$

$$
W_2(f) = T \left( \frac{\sin \pi f T}{\pi f T} \right)^2
$$

#### 2.3 钟形（Gauss）时窗

$$
w_3(t) =
\begin{cases}
\exp\!\left[-\alpha\left(\dfrac{t}{T}\right)^2\right], & |t| \le T \\\\
0, & \text{其他}
\end{cases}
$$

$$
W_3(f) \approx \frac{\sqrt{\pi} T^2}{\alpha} e^{-\frac{\pi^2 T^4 f^2}{\alpha}}
$$

#### 2.4 哈宁（Hanning）时窗

$$
w_4(t) =
\begin{cases}
\dfrac{1}{2}\left(1 + \cos \dfrac{\pi t}{T}\right), & |t| \le T \\\\
0, & \text{其他}
\end{cases}
$$

$$
W_4(f) = \frac{1}{2}W_1(f) + \frac{1}{4}\left[W_1\!\left(f - \frac{1}{2T}\right) + W_1\!\left(f + \frac{1}{2T}\right)\right]
= \frac{\sin 2\pi f T}{2\pi f} + \frac{1}{2} \cdot \frac{\sin 2\pi f T}{1 - (2Tf)^2}
$$

#### 2.5 汉明（Hamming）时窗

$$
w_5(t) =
\begin{cases}
0.54 + 0.46 \cos \dfrac{\pi t}{T}, & |t| \le T \\\\
0, & \text{其他}
\end{cases}
$$

$$
\begin{aligned}
W_5(f) &= 0.54W_1(f) + 0.23\!\left[W_1\!\left(f - \frac{1}{2T}\right) + W_1\!\left(f + \frac{1}{2T}\right)\right]\\\\
&= \frac{\sin 2\pi f T}{\pi f} \left[ 0.54 - \frac{0.08 \cos 2\pi f T}{1 - (2Tf)^2} \right]
\end{aligned}
$$

#### 2.6 帕曾（Parzen）时窗

$$
w_6(t) =
\begin{cases}
1 - 6\left(\dfrac{t}{T}\right)^2 + 6\left|\dfrac{t}{T}\right|^3, & |t| \le \dfrac{T}{2} \\\\
2\left(1 - \dfrac{|t|}{T}\right)^3, & \dfrac{T}{2} < |t| \le T \\\\
0, & |t| > T
\end{cases}
$$

$$
W_6(f) = \frac{3}{4} \left( \frac{\sin(\pi f T / 2)}{\pi f T / 2} \right)^4
$$

#### 2.7 截尾丹尼尔（Truncated Daniell）时窗

$$
w_7(t) =
\begin{cases}
\dfrac{\sin (\pi t / T)}{\pi t / T}, & |t| \le T \\\\
0, & |t| > T
\end{cases}
$$

$$
W_7(f) = W_1(f) \ast U(f),\quad \text{其中} \quad
U(f) =
\begin{cases}
T, & |f| \le \dfrac{1}{2T} \\\\
0, & |f| > \dfrac{1}{2T}
\end{cases}
$$

#### 2.8 布拉克曼（Blackman）时窗

$$
w_8(t) =
\begin{cases}
0.42 + 0.5 \cos \dfrac{\pi t}{T} + 0.08 \cos \dfrac{2\pi t}{T}, & |t| \le T \\\\
0, & \text{其他}
\end{cases}
$$

$$
\begin{aligned}
W_8(f) =\ &0.42W_1(f) + 0.25\!\left[W_1\!\left(f - \frac{1}{2T}\right) + W_1\!\left(f + \frac{1}{2T}\right)\right] \\\\
&+ 0.04\!\left[W_1\!\left(f - \frac{1}{T}\right) + W_1\!\left(f + \frac{1}{T}\right)\right]
\end{aligned}
$$

#### 2.9 凯苏（Kaiser）时窗

$$
w_9(t) =
\begin{cases}
\dfrac{I_0\!\left(\beta \sqrt{1 - (t/T)^2}\right)}{I_0(\beta)}, & |t| \le T \\\\
0, & |t| > T
\end{cases}
$$

其中$I_0$为修正的第一类零阶贝塞尔函数，$\beta$为形状参数。

$$
W_9(f) =
\begin{cases}
\dfrac{2T \sin \sqrt{(2\pi f T)^2 - \beta^2}}{I_0(\beta) \sqrt{(2\pi f T)^2 - \beta^2}}, & 2\pi |f| T > \beta \\\\
\dfrac{2T \sinh \sqrt{\beta^2 - (2\pi f T)^2}}{I_0(\beta) \sqrt{\beta^2 - (2\pi f T)^2}}, & 2\pi |f| T < \beta
\end{cases}
$$

:::table align="center" fullWidth copy=false
| 时窗函数 | 旁瓣峰值 (dB) | 过渡带宽度 $c$ | 阻带衰减 (dB) |
| :-------: | :------------: | :------------: | :-----------: |
| 矩形     | –13           | $0.9/N$       | –21           |
| 三角形   | –25           | $2.1/N$       | –25           |
| 哈宁     | –31           | $3.1/N$       | –44           |
| 汉明     | –41           | $3.3/N$       | –53           |
| 布拉克曼 | –57           | $5.5/N$       | –74           |
:::

:::note
**设计时窗函数步骤**：
  :::steps
  0. 已知滤波器所需技术指标。
  1. 由 $\delta_s$ 查表选取窗类型。
  2. 由过渡带宽 $\Delta \omega = \omega_s - \omega_p$ 和 $c = \frac{\Delta \omega}{2\pi}$ 确定 $N$。
  3. 取理想滤波器截频为过渡带中点。
  4. 考虑物理可实现取 $N/2$ 保证因果性；
  5. 构造 $h(n) = h_{\text{ideal}}(n) \cdot w(n)$。
  :::
:::

### 3. 最佳时窗函数

#### **3.1 最大振幅比时窗（切比雪夫窗）**

设离散时窗 $h_n = h_{-n}$，则频谱 $H(f) = \sum_{n=-N}^N h_n \cos 2\pi n \Delta f$。给定 $0 < \delta < \frac{1}{2\Delta}$，要求 $(-\delta,\delta)$ 是时窗函数频谱的主瓣范围。

使振幅比

$$
Q(h) = \frac{H(0)}{\max_{\delta \le |f| \le \frac{1}{2\Delta}} |H(f)|}
$$

达最大的时窗函数 $w_n$ 称为**最大振幅比时窗函数**，其频谱对应**切比雪夫多项式**：

$$
P_N(x) = \cos \left[ N \arccos \left( \frac{2x - a - 1}{a - 1} \right) \right]
$$

$$
x = \cos 2\pi \Delta f, \quad a = \cos 2\pi \delta \Delta < 1
$$

#### **3.2 最大能量比时窗**

给定 $0 < \delta < \frac{1}{2\Delta}$，希望 $H(f)$ 的能量集中在区间 $(-\delta,\delta)$ 内。

定义使能量比

$$
Q(h) = \frac{\int_{-\delta}^\delta |H(f)|^2 \, df}{\int_{-\frac{1}{2\Delta}}^{\frac{1}{2\Delta}} |H(f)|^2 \, df}
$$

达最大的时窗函数 $h_n$ 为**最大能量比时窗函数**，对应如下**特征值问题**最大特征根 $Q(h)$ 的特征向量。

$$
\sum_{n=-N}^N \frac{\sin 2\pi (n - k) \delta \Delta}{\pi (n - k) \Delta} h_n = Q(h) \cdot h_k, \quad k = -N, \dots, N
$$

## §3 广义线性相位滤波器，有限长脉冲响应滤波器设计的其他方法

### 1. 广义线性相位有限长脉冲响应滤波器

设有限长物理可实现滤波器：

$$
h(n) = \begin{cases} h(n), & 0 \le n \le M \\ 0, & \text{其他} \end{cases}
$$

:::table copy=false maxContent=true
| 类型 | 对称性 |$M$ 奇偶性 | 频谱 $H(e^{-i\omega})$ | 特点 |
| - | - | - | - | - |
| **Ⅰ类** |$h(n) = h(M-n)$ | 偶 |$e^{-i\omega M/2} \sum_{k=0}^{M/2} a(k) \cos k\omega$ | 广义线性相位，$\phi(\omega) = -\omega M/2$ |
| **Ⅱ类** |$h(n) = h(M-n)$ | 奇 |$e^{-i\omega M/2} \sum_{k=1}^{(M+1)/2} b(k) \cos[(k - \frac{1}{2})\omega]$| 广义线性相位，$\omega = \pi$ 处必为零 |
| **Ⅲ类** |$h(n) = -h(M-n)$| 偶 |$ie^{-i\omega M/2} \sum_{k=1}^{M/2} c(k) \sin k\omega$ | 广义线性相位，$\omega = 0, \pi$ 处必为零 |
| **Ⅳ类** |$h(n) = -h(M-n)$| 奇 |$ie^{-i\omega M/2} \sum_{k=1}^{(M+1)/2} d(k) \sin[(k - \frac{1}{2})\omega]$| 广义线性相位，$\omega = 0$ 处必为零 |
:::

:::note
**线性相位滤波器**：$A(e^{-i\omega})=|H(e^{-i\omega})|$，$\phi(\omega) = -i\alpha \omega$。

**广义线性相位滤波器**：$A(e^{-i\omega})$ 可取负值，$\phi(\omega) = -i(\alpha \omega + \beta)$。

非线性相位滤波器是信号波形产生畸变，因此在设计滤波器时，希望其具有线性相位，或者广义线性相位。
:::

### 2. 频率抽样法

设理想滤波器频谱为 $H(e^{-j\omega})$，取 $N$ 点频率 $\omega_k = \frac{2\pi k}{N}$，$k = 0,1,\dots,N-1$，则根据有限离散傅氏变换，近似 FIR 滤波器为：

$$
h_N(n) = \frac{1}{N} \sum_{k=0}^{N-1} H(e^{-i\omega_k}) e^{i\omega_k n}, \quad 0 \le n \le N-1
$$

且与原脉冲响应有如下关系：

$$
h_N(n) = \sum_{k=-\infty}^{\infty} h(n + kN), \quad 0 \le n \le N-1
$$

:::note
优化方法：

 - 将主能量部分时移至 $[0, N-1]$。
 - 对频谱镶边使之光滑。
:::

### 3. 误差最大最小优化法（切比雪夫逼近）

以低通滤波为例，定义加权误差：

$$
E(e^{-i\omega}) = W(e^{-i\omega}) \left[ H_L(e^{-i\omega}) - A(e^{-i\omega}) \right]
$$

其中

$$
W(e^{-i\omega}) = \begin{cases} \dfrac{\delta_s}{\delta_p}, & 0 \le \omega \le \omega_p \\\\ 1, & \omega_s \le \omega \le \pi \end{cases}, \quad
H_L(e^{-i\omega}) = \begin{cases} 1, & 0 \le \omega \le \omega_p \\\\ 0, & \omega_s \le \omega \le \pi \end{cases}
$$

![](/GSP/parks-mcclellan.png)

为设计Ⅰ类广义线性 FIR 滤波器，希望

$$
A(e^{-i\omega})=\sum_{k=0}^{M/2} a(k) \cos k\omega \approx H_L(e^{-i\omega})
$$

系数 $a(k)$ 需要使得频率域 $F$ 上误差 $E(e^{-i\omega})$ 的最大绝对值最小。

$$
\min_{a(k)} \left( \max_{\omega \in F} |E(e^{-i\omega})| \right), \quad F = [0, \omega_p] \cup [\omega_s, \pi]
$$

该问题即**切比雪夫最佳逼近问题**，其数值解法为 **Parks-McClellan 算法**。
