---
title: '第八章：相关分析'
createTime: 2026/01/29 21:04:23
permalink: /GSP/rxq70vwz/
---

:::note
本章核心：定义相关系数与相关函数；揭示相关与褶积的等价关系；讨论自相关与互相关的性质；引入循环相关及其与普通相关的联系；拓展至多道信号相关分析。
:::

## §1 相关的基本概念，相关与褶积的关系

### 1. 相关系数

设离散信号 $x_n$ 与 $y_n$，定义其在区间 $[N_1, N_2]$ 上的**相关系数**为：

$$
\rho_{xy}(N_1, N_2) = \frac{\sum_{n=N_1}^{N_2} x_n y_n}{\sqrt{\sum_{n=N_1}^{N_2} x_n^2} \cdot \sqrt{\sum_{n=N_1}^{N_2} y_n^2}}
$$

其物理意义：

- $|\rho_{xy}(N_1, N_2)| \approx 1$：两信号高度相似（线性相关）。
- $|\rho_{xy}(N_1, N_2)| \approx 0$：两信号不相似（正交或无关）。

对能量有限信号（$\sum |x_n|^2 < \infty$，$\sum |y_n|^2 < \infty$），定义**无界相关系数**为：

$$
r_{xy} = \sum_{n=-\infty}^{\infty} x_n y_n
$$

称 $r_{xy}$ 为**未标准化的相关系数**，仍反映相似性程度。


### 2. 相关函数

为考虑信号时移下的相似性，引入**互相关函数**：

$$
r_{xy}(\tau) = \sum_{n=-\infty}^{\infty} x_n y_{n-\tau}, \quad \tau \in \mathbb{Z}
$$

- $\tau$：$y$ 相对于 $x$ 的延迟。
- 若 $|r_{xy}(\tau_0)| = \max_\tau |r_{xy}(\tau)|$，表明 $y_{n-\tau_0}$ 与 $x_n$ 最相似。
- 互相关**不可交换**，但满足：

$$
r_{yx}(\tau) = r_{xy}(-\tau)
$$

**自相关函数**：

$$
r_{xx}(\tau) = \sum_{n=-\infty}^{\infty} x_n x_{n-\tau}
$$


### 3. 相关与褶积的关系

有**实**离散信号 $x_n, y_n$，则其互相关函数 $r_{xy}$ 与褶积满足：

$$
r_{xy} = x_n * y_{-n}
$$

设 $X(f), Y(f), R_{xy}(f)$ 分别为 $x_n, y_n, r_{xy}$ 的频谱，则：

$$
R_{xy}(f) = X(f) \cdot \overline{Y(f)}
$$

设 $X(Z), Y(Z), R_{xy}(Z)$ 为其 Z 变换，则：

$$
R_{xy}(Z) = X(Z) \cdot Y\left(Z^{-1}\right)
$$



## §2 相关函数的性质

### 1. 自相关函数的性质

设能量有限实信号 $x_n$，其自相关函数 $r_{xx}(\tau)$ 具有如下性质：

- $|r_{xx}(\tau)| \le r_{xx}(0)$，最大值在 $\tau = 0$ 处。
- $r_{xx}(-\tau) = r_{xx}(\tau)$（偶函数）。
- $\lim_{|\tau| \to \infty} r_{xx}(\tau) = 0$ 。
- 自相关函数 $r_{xx}(\tau)$ 的波形只与信号的振幅谱有关（因 $R_{xx}(f) = |X(f)|^2$）。
- 自相关矩阵为**正定陶布利兹矩阵**：

$$
\begin{bmatrix}
r_{xx}(0) & r_{xx}(1) & \cdots & r_{xx}(N) \\
r_{xx}(1) & r_{xx}(0) & \cdots & r_{xx}(N-1) \\
\vdots & \vdots & \ddots & \vdots \\
r_{xx}(N) & r_{xx}(N-1) & \cdots & r_{xx}(0)
\end{bmatrix}
$$

**定理 1（自相关充要条件）**

序列 $r(n)$ 为某能量有限信号的自相关函数的**充分必要条件**是其频谱 $R(f) \ge 0$ 。

即：$r(n) = r_{gg}(n)$ 当且仅当 $R(f) = |G(f)|^2 \ge 0$ 。

**定理 2（单边自相关性质）**

设 $r(n)$ 为自相关函数，$r(0) > 0$，定义**单边自相关函数**：

$$
g(n) =
\begin{cases}
r(n), & n \ge 0 \\
0, & n < 0
\end{cases}
$$

其 Z 变换为

$$
G(Z) = \sum_{n=0}^{\infty} r(n) Z^{n}
$$

则其在单位圆内无零点（即 $G(Z) \ne 0$，当 $|Z| < 1$），且其频谱实部满足：

$$
\operatorname{Re} G(f) = \frac{1}{2} [R(f) + r(0)]
$$

:::note
推论：单边自相关函数 $g(n)$ 是**最小相位信号**。
:::

### 2. 互相关函数的性质

能量有限实信号 $x_n, y_n$，其互相关函数 $r_{xy}(\tau)$ 满足：

- 对称性：$r_{yx}(\tau) = r_{xy}(-\tau)$ 。
- 不等式：

$$
|r_{xy}(\tau)| \le \sqrt{r_{xx}(0) \cdot r_{yy}(0)}
$$

- $\lim_{|\tau| \to \infty} r_{xy}(\tau) = 0$ 。
- 互相关函数**仅包含** $x_n$ 与 $y_n$ 共有的频率成分（因 $R_{xy}(f) = X(f)\overline{Y(f)}$）。



## §3 循环相关和普通相关

### 1. 有限离散傅氏变换的循环相关

设长度为 $N$ 的实信号：

$$
x_n = (x_0, x_1, \dots, x_{N-1}),\quad y_n = (y_0, y_1, \dots, y_{N-1})
$$

它们的有限离散频谱为 $X_m, Y_m$。定义**循环互相关**为：

$$
r_{xy}^{(N)}(n) = x_n * y_{-n} \ [N] = \sum_{k=0}^{N-1} x_k y_{(k-n) \bmod N}
$$

循环互相关 $r_{xy}^{(N)}(n)$ 与频谱关系为：

$$
r_{xy}^{(N)}(n) \quad \overset{\text{FDFT}}{\longleftrightarrow} \quad X_m \cdot \overline{Y_m}
$$

### 2. 循环相关与普通相关的关系

设原始信号为：

$$
x_n =
\begin{cases}
x_n, & 0 \le n \le M-1 \\
0, & \text{其他}
\end{cases},\quad
y_n =
\begin{cases}
y_n, & 0 \le n \le L-1 \\
0, & \text{其他}
\end{cases}
$$

以 $N$ 为周期延拓得 $x_n^{(N)}, y_n^{(N)}$，定义其循环相关为 $r_{xy}^{(N)}(n)$。

**循环相关定理**

当 $0 \le n \le N - L$ 时，有：

$$
r_{xy}(n) = r_{xy}^{(N)}(n)
$$

特别地，若 $N \ge M + L - 1$，则对所有 $0 \le n \le N-1$，均有：

$$
r_{xy}^{(N)}(n) =
\begin{cases}
r_{xy}(n), & 0 \le n \le N - L \\
r_{xy}(n - N), & N - L < n \le N-1
\end{cases}
$$

### 3. 利用 FFT 计算相关函数

#### 3.1 互相关计算

设实离散信号
$$
x_n = 
\begin{cases}
x_n, & 0 \le n \le M-1 \\
0, & \text{其他}
\end{cases}
\qquad 
y_n = 
\begin{cases}
y_n, & 0 \le n \le L-1 \\
0, & \text{其他}
\end{cases}
$$
现需计算：  
$$
r_{xy}(n), \quad 0 \le n \le K
$$
:::steps
1. 选 $N = 2^k \ge L + K$
2. 构造周期延拓信号 $x_n^{(N)}, y_n^{(N)}$
3. 用 FFT 计算 $X_m, Y_m$
4. 计算 $R_m = X_m \cdot \overline{Y_m}$
5. 用 IFFT 得 $r_{xy}^{(N)}(n)$，取 $0 \le n \le N-L$ 即为 $r_{xy}(n)$
:::

#### 3.2 自相关计算

设 $x_n$ 为长度 $M$ 信号
$$
x_n = 
\begin{cases}
x_n, & 0 \le n \le M-1 \\
0, & \text{其他}
\end{cases}
$$
其自相关函数为  
$$
r_{xx}(n) = 
\begin{cases}
\sum_{l=0}^{M-1} x_{l} x_{n+l}, & |n| \le M-1 \\
0, & |n| > M-1
\end{cases}
$$
由于 $r_{xx}(n) = r_{xx}(-n)$，只需计算 $0 \le n \le M-1$。

:::steps
1. 取 $N = 2^k \ge 2M - 1$
2. 构造周期延拓信号 $x_n^{(N)}$
3. 用 FFT 计算 $X_m$
4. 计算 $R_m = |X_m|^2$
5. 用 IFFT 得 $r_{xx}^{(N)}(n)$，取 $0 \le n \le N-M$ 即为 $r_{xx}(n)$
:::

#### 3.3 分段求和法

当 $L$ 较大时，若按前述选 $N \ge L + K$，则 $N \approx L$ 过大，内存和硬件受限，此时可采用**分段求和法**。

$$
K = 2^q \quad L = J \cdot K
$$

:::steps
1. 取 $N = 2K$  
2. 定义 $J$ 段子信号（长度为 $N$）
   $$
   y^{(j)}_n = 
   \begin{cases}
   y_{n + jK}, & 0 \le n < K \\
   0, & K \le n < 2K
   \end{cases}
   $$
   $$
   x^{(j)}_n = x_{n + jK},\quad 0 \le n < 2K
   $$
   
3. 对每段信号计算互相关
   
   - 计算 $X^{(j)}_m = \text{FFT}[x^{(j)}_n]$，$Y^{(j)}_m = \text{FFT}[y^{(j)}_n]$  
   - $R^{(j)}_m = X^{(j)}_m \cdot \overline{Y^{(j)}_m}$
   - $r^{(j)}_n = \text{IFFT}[R^{(j)}_m],\quad 0 \le n < 2K$  
   - 取前 $K$ 点：$r_{xy}^{(j)}(n) = r^{(j)}_{n}, \quad 0 \le n < K$
   
4. 累加得最终结果
   $$
   r_{xy}(n) = \sum_{j=0}^{J-1} r_{xy}^{(j)}(n), \quad 0 \le n < K
   $$
:::


## §4 多道相关

设 $M$ 道信号 $x_j(n),\ 1 \le j \le M,\ 1 \le n \le N$，定义其与**标准信号 $\bar{x}(n)$** 的**总误差能量**为：

$$
Q = \sum_{j=1}^{M} \sum_{n=1}^{N} [x_j(n) - \bar{x}(n)]^2
$$

当 $\bar{x}(n)$ 使 $Q$ 最小（即 $\bar{x}(n) = \frac{1}{M} \sum_{j=1}^{M} x_j(n)$，算术平均）时，得：

$$
Q = \sum_{j=1}^{M} \sum_{n=1}^{N} x_j^2(n) - M \sum_{n=1}^{N} \bar{x}^2(n)
$$

定义以下**多道相似性度量标准**：


|  标准         |  表达式       | 物理意义             |
| -- | -- | -- |
| **能量比标准** $E$       | $E = \dfrac{M \sum_n \bar{x}^2(n)}{\sum_j \sum_n x_j^2(n)}$                    | 平均信号能量占比     |
| **叠加能量标准** $D$     | $D = M \sum_n \bar{x}^2(n) = \dfrac{1}{M} \sum_n \left(\sum_j x_j(n)\right)^2$ | 堆叠后能量大小       |
| **叠加振幅标准** $S$     | $S = \dfrac{1}{M} \sum_n \left\| \sum_j x_j(n) \right\|$   | 堆叠振幅和 |
| **未标准化相关系数** $K$ | $K = \sum_{i \ne j} \sum_n x_i(n) x_j(n) = \sum_n(\sum_j x_j(n))^2-\sum_j\sum_n x_j^2(n)$ | 两两互相关之和       |
| **标准化相关系数** $R$   | $R = \dfrac{K}{(M-1) \sum_j \sum_n x_j^2(n)}$                                  | 归一化多道相似度     |
| **相对误差能量** | $\dfrac{Q}{\sum_j\sum_n x_j^2(n)}=\dfrac{M-1}{M}(1-R)$ | 总误差能量与总能量之比 |

:::note
$0 \le E \le 1$

$0 \le D \le \sum_j\sum_n x_j^2(n)$

$- \dfrac{1}{M-1} \le R \le 1$

$-\sum_j\sum_n x_j^2(n) \le K \le (M-1)\sum_j\sum_n x_j^2(n)$

$E = 1$ 或 $R = 1$ 等价于所有 $x_j(n)$ 波形完全相同，因此对多道信号预先进行**规格化处理**能更直接反映相似性。
:::