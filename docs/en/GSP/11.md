---
title: '第十一章：递归滤波器的设计'
createTime: 2026/01/29 22:19:20
permalink: /en/GSP/ollc6u6y/
---

:::note
本章核心：介绍递归滤波器（IIR）的基本概念、稳定性判定；详述模拟滤波器设计原理（巴特沃斯、切比雪夫）；重点讲解双线性变换法将模拟滤波器转换为数字递归滤波器的过程；补充脉冲响应不变法及最优化设计思想。
:::

## §1 递归滤波及其稳定性

### 1. 递归滤波的基本形式
设输入信号为 $x(t)$，输出信号为 $y(t)$，递归滤波器的差分方程为：
$$
y(t) = \sum_{i=0}^{n} b_i x(t-i) - \sum_{j=1}^{m} a_j y(t-j)
$$
其 Z 变换关系为：
$$
Y(Z) = H(Z) X(Z), \quad H(Z) = \frac{B(Z)}{A(Z)}, \quad B(Z) = \sum_{i=0}^{n} b_i Z^{i}, \quad A(Z) = 1 + \sum_{j=1}^{m} a_j Z^{j}
$$
称 $H(Z)$ 为递归滤波器的系统函数或传递函数。

### 2. 递归滤波的稳定性

**定义**

若 $y(t)$ 的初始值有误差
$$
\tilde{y}(t) = y(t) + \varepsilon(t),\quad 0 \leq t \leq m-1
$$
令 $e(t) = \tilde{y}(t) - y(t)$，由递推关系得
$$
\begin{cases}  e(t) = -\sum_{j=1}^{m}a_j e(t-j) & t \geq m \\ e(t) = \varepsilon(t) & 0 \leq t \leq m-1 \end{cases}
$$
若对任何初始噪声 $\varepsilon(t)$，当 $t \to \infty$ 时，有 $e(t) \to 0$，则称递归滤波是稳定的。

**性质 1（稳定性定理）**

递归滤波器稳定的充分必要条件是：多项式 $A(Z) = 1 + a_1 Z + \cdots + a_m Z^m$ 的根全部在单位圆外。

:::tip
此性质等价于第四章 §2 中关于线性时不变系统稳定性的结论。
:::

### 3. 正向与反向递归滤波  
- **正向递归滤波**：从 $t = m$ 开始，利用初始值 $y(0), y(1), \dots, y(m-1)$ 向后递推计算 $y(t)$。
- **反向递归滤波**：从 $t = -m$ 开始，利用初始值 $y(-m+1), \dots, y(0)$ 向前递推计算 $y(t)$。

$$
y(t) = \sum_{i=0}^{n} b_i x(t+i) - \sum_{j=1}^{m} a_j y(t+j)
$$

**性质 2（反向递归滤波稳定性）**

反向递归滤波器稳定的充分必要条件是：多项式 $A(Z)$ 的根全部在单位圆外。

:::note
当滤波器分母多项式根在单位圆内时，应采用反向递归滤波。
:::

## §2 模拟滤波器的设计

在无线电工程中，已设计出许多电滤波器（由电阻、电容等元件组成），可对连续信号进行低通、高通、带通、带阻等滤波。这类处理连续信号的电滤波器称为**模拟滤波器**。其脉冲响应为 $h(t)$，频率响应为：
$$
H(\omega) = \int_{-\infty}^{\infty} h(t) e^{-i\omega t} dt
$$
本节讨论如何根据技术指标设计不同类型的模拟滤波器，主要包括**巴特沃斯滤波器**和**切比雪夫滤波器**。

### 1. 低通模拟滤波器的设计

由于模拟滤波器无法达到理想滤波器的效果，只能提出近似的要求。

假定 $\omega_c=1$ ，可以设低通模拟滤波器的振幅谱平方为：
$$
|H(\omega)|^2 = \frac{1}{1 + g^2(\omega)}
$$
其中 $g(\omega)$ 是 $\omega$ 的实系数有理函数，且满足：

- $|g(-\omega)| = |g(\omega)|$
- 当 $\omega < 1$ 时，$g(\omega) \approx 0$（通带内波动小）
- 当 $\omega > 1$ 时，$g(\omega) \approx \infty$（阻带内衰减大）

由于 $|H(\omega)|^2$ 是 $\omega$ 的有理函数，可表示为：
$$
|H(\omega)|^2 = \frac{P_1(\omega)}{P_2(\omega)}
$$
其中 $P_1(\omega), P_2(\omega)$ 为实系数多项式，且当 $\omega$ 取实值时，$P_1(\omega) > 0, P_2(\omega) > 0$。

设 $\alpha_j$ 为 $P_1(\omega)$ 的虚部大于0的根，$\beta_i$ 为 $P_2(\omega)$ 的虚部大于0的根，则
$$
|H(\omega)|^2 = k^2 \frac{(\omega - \alpha_1)(\omega - \overline{\alpha}_1)(\omega - \alpha_2)(\omega - \overline{\alpha}_2)\cdots}{(\omega - \beta_1)(\omega - \overline{\beta}_1)(\omega - \beta_2)(\omega - \overline{\beta}_2)\cdots}
$$
取
$$
H(\omega) = k \frac{(\omega - \alpha_1)(\omega - \alpha_2)\cdots}{(\omega - \beta_1)(\omega - \beta_2)\cdots}
$$
则 $H(\omega)$ 为在 $\omega$ 的下半平面内无零点和极点，为最小相位滤波器，并可通过模拟电路实现。

:::note
巴特沃斯低通滤波器：$g(\omega)=\omega^n$

切比雪夫低通滤波器：$g(\omega)=\varepsilon T_n(\omega)=\varepsilon\cos (n\arccos\omega)$
:::

### 2. 高通模拟滤波器的设计

通过频率变换将低通滤波器转换为高通滤波器：
$$
\omega = -\frac{1}{\lambda}
$$
代入低通滤波器频谱 $H(\omega)$，得到高通滤波器频谱 $H(\lambda)$。

![](/GSP/high-pass-filter-design.png)

### 3. 带通模拟滤波器的设计

通过频率变换：
$$
\omega = \lambda - \frac{q^2}{\lambda}\quad q>0
$$
代入低通滤波器频谱 $H(\omega)$，得到高通滤波器频谱 $H(\lambda)$。该变换将低通区间 $[-1, 1]$ 映射为带通区间 $[-\lambda_1, -\lambda_{-1}] \cup [\lambda_{-1}, \lambda_1]$。

![](/GSP/band-pass-filter-design.png)

### 4. 带阻模拟滤波器的设计

通过组合高通和带通变换：
$$
\omega = -\frac{1}{\lambda-\frac{q^2}{\lambda}}= \frac{1}{\frac{q^2}{\lambda}-\lambda}\quad q>0
$$
该变换将低通区间 $[-1, 1]$ 映射为带阻区间 $[-\lambda_1, -\lambda_{-1}] \cup [\lambda_{-1}, \lambda_1]$。

### 5. 巴特沃斯低通模拟滤波器

:::note

$$
|H(\omega)|^2 = \frac{1}{1 + \omega^{2n}}
$$
$$
|H(0)|=1 \quad |H(\omega_0)|=\frac{1}{\sqrt{2}}
$$
$$  
20\lg\frac{|H(0)}{|H(\omega_c)|}=10\lg2=3.0103 \text{dB}
$$

因此称 $\omega_c$ 为 **3dB 截止频率**，当 $\omega_c=1$ 时，巴特沃斯低通滤波器称为**归一化巴特沃斯低通模拟滤波器**。

:::

**极点分布**

极点 $\beta_k$ 满足：
$$
\beta_k^{2n} = -1 = e^{i(2k-1)\pi}, \quad k=1,2,\dots,2n
$$
解得：
$$
\beta_k = e^{i(2k-1)\pi/(2n)}, \quad k=1,2,\dots,2n
$$
在上半平面的极点为 $\beta_k, k=1,2,\dots,n$。

**一般形式**
$$
H(\omega) = \frac{1}{(\omega - \beta_1)(\omega - \beta_2)\cdots(\omega - \beta_n)}
$$
其中 $\beta_k = e^{i(2k-1)\pi/(2n)}$。

**具体实例**

- **一阶巴特沃斯**：
  $$
  H(\omega) = \frac{1}{\omega - i}
  $$

- **二阶巴特沃斯**：
  $$
  H(\omega) = \frac{1}{\omega^2 - i\sqrt{2}\omega - 1}
  $$

- **三阶巴特沃斯**：
  $$
  H(\omega) = \frac{1}{(\omega - i)(\omega - i\omega - 1)}
  $$

### 6. 低通模拟滤波的技术要求

给定技术要求：通带截止频率 $f_p$，阻带截止频率 $f_s$，通带波动 $\delta_p$，阻带波动 $\delta_s$。
$$
A=\frac{1}{\delta_s}\quad \delta_p=1-\frac{1}{\sqrt{1+\varepsilon^2}}
$$

![](/GSP/low-pass-filter-specifications.png)

需要设计一个巴特沃斯低通模拟滤波器。

:::steps
1. 计算判别因子 $d$ 和选择性因子 $k$：
   $$
   d = \left(\frac{(1-\delta_p)^{-2}-1}{\delta_s^{-2} - 1}\right)^{1/2}=\frac{\varepsilon}{\sqrt{A^2-1}}, \quad k = \frac{\omega_p}{\omega_s}
   $$
2. 确定阶数 $n$：
   $$
   n \ge \frac{\lg d}{\lg k}
   $$
3. 确定 3dB 截止频率 $\omega_c$：
   $$
   \omega_p((1-\delta_p)^{-2}-1)^{-1/2n} \leq \omega_c \leq \omega_s(\delta_s^{-2}-1)^{-1/2n}
   $$
   
4. 由 $n$ 和 $\omega_c$ 确定巴特沃斯滤波器。
:::


## §3 数字递归滤波器的设计

### 1. 双线性变换

双线性变换定义为
$$
\omega=\frac{A}{i}\cdot\frac{1-Z}{1+Z},\quad A>0 \\
$$
当 $Z$ 在单位圆上取值时，有
$$
Z=e^{-i\varphi},\quad \varphi=2\pi \Delta f
$$
$$
\omega = A\tan\frac{\varphi}{2}
$$
这表明，双线性变换把 $Z$ 平面的单位圆变成了 $\omega$ 平面的实轴。$\omega$ 平面的下半平面与 $Z$ 平面的单位圆内相对应，$\omega$ 平面的上半平面与 $Z$ 平面的单位圆外相对应。

### 2. 数字递归滤波器

**低通数字递归滤波器**

设低通范围为 $[-f_1, f_1]$，对应的 $Z$ 平面点为 $Z = e^{\pm i 2\pi f_1 \Delta}= e^{\pm i \varphi_1}$。通过对应关系可得双线性变换
$$
Z\text{ 平面的 }e^{-i\varphi_1}\leftrightarrow \omega \text{ 平面的 } 1 
$$
$$
\omega=\frac{1}{i\tan\pi\Delta f_1}\cdot\frac{1-Z}{1+Z}
$$

:::note
以一阶巴特沃斯低通模拟滤波器为例：
$$
H(Z) = \frac{1 + Z}{(1 + A) + (1 - A)Z}, \quad A = \frac{1}{\tan(\pi \Delta f_1)}
$$
:::

**带通数字递归滤波器**

设带通范围为 $[-f_2, -f_1] \cup [f_1, f_2]$，令
$$
\varphi_1=2\pi\Delta f_1\quad\varphi_2=2\pi\Delta f_2
$$
由前带通模拟滤波器的设计，此时应考虑 $\lambda$ 平面与 $Z$ 平面的双线性变换
$$
\lambda=\frac{A}{i}\cdot\frac{1-Z}{1+Z},\quad A>0
$$
$$
Z \text{ 平面的 }e^{-i\varphi_1}\leftrightarrow \lambda \text{ 平面的 } \lambda_{-1}
$$
$$
Z \text{ 平面的 }e^{-i\varphi_2}\leftrightarrow \lambda \text{ 平面的 } \lambda_{1}
$$

结合对应关系和带通模拟滤波器的映射关系，有下面关系式
$$
A = \frac{1}{\tan \frac{\varphi_2}{2} - \tan \frac{\varphi_1}{2}} = \frac{1}{\tan \pi \Delta f_2 - \tan \pi \Delta f_1}
$$
$$
q^2 = A^2 \tan \frac{\varphi_1}{2} \tan \frac{\varphi_2}{2} = A^2 \tan \pi \Delta f_1 \tan \pi \Delta f_2
$$
最终的变换关系为
$$
\begin{aligned}
\omega &= \lambda - \frac{q^2}{\lambda} = -\mathrm{i}A \frac{1 - Z}{1 + Z} + \frac{q^2}{\mathrm{i}A \frac{1 - Z}{1 + Z}} \\\\
&= \frac{(A^2 + q^2) + 2(q^2 - A^2)Z + (A^2 + q^2)Z^2}{\mathrm{i}A(1 - Z^2)} \\\\
&= \frac{1 + 2\mu Z + Z^2}{\mathrm{i}\nu(1 - Z^2)}
\end{aligned}
$$

其中

$$
\mu = \frac{q^2 - A^2}{A^2 + q^2}=\frac{-\cos \pi \Delta (f_1 + f_2)}{\cos \pi \Delta (f_2 - f_1)}
$$
$$
\nu = \frac{A}{A^2 + q^2}=\tan \pi \Delta (f_2 - f_1)
$$

:::note
以一阶巴特沃斯低通模拟滤波器为例：
$$
H(Z) = \frac{\nu(1 - Z^2)}{(1 + \nu) + 2\mu Z + (1 - \nu)Z^2}
$$
:::

**带阻数字递归滤波器**

设带阻范围为 $[-f_2, -f_1] \cup [f_1, f_2]$，参照带通数字递归滤波器的设计方法可得

$$
\omega = \frac{-\mathrm{i}\nu(1 - Z^2)}{1 + 2\mu Z + Z^2}
$$

其中

$$
\mu = \frac{q^2 - A^2}{A^2 + q^2}=\frac{-\cos \pi \Delta (f_1 + f_2)}{\cos \pi \Delta (f_2 - f_1)}
$$
$$
\nu = \frac{A}{A^2 + q^2}=\tan \pi \Delta (f_2 - f_1)
$$

:::note
以一阶巴特沃斯低通模拟滤波器为例：
$$
H(Z) = \frac{1 + 2\mu Z + Z^2}{(1 + \nu) + 2\mu Z + (1 - \nu)Z^2}
$$
:::

**高通数字递归滤波器**

设高通范围为 $[-1/(2\Delta), -f_1] \cup [f_1, 1/(2\Delta)]$，则对应变换为
$$
\omega=\frac{1}{iA}\cdot\frac{1+Z}{1-Z}=-i\tan\pi\Delta f_1\cdot\frac{1+Z}{1-Z}
$$
:::note
以一阶巴特沃斯低通模拟滤波器为例：
$$
H(Z) = \frac{1 - Z}{(\tan(\pi \Delta f_1) + 1) + (\tan(\pi \Delta f_1) - 1)Z}
$$
:::

### 3. 关于递归滤波器设计的说明

- **Z 平面法**
- **最优化法**
- **转换法**
  - 频率域转换法：把模拟滤波器的频谱通过双线性变换转换为数字递归滤波器的 Z 变换
  - 时间域转换法——脉冲响应不变转换法：把模拟滤波器脉冲响应 $h(t)$，以 $\Delta$ 为抽样间隔直接抽样得 $h(n\Delta)$，由此可得数字递归滤波器 $Z$ 变换 $H(Z) = \sum_{n=0}^{+\infty} h(n\Delta) Z^n$。

